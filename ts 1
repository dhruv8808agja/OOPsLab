import java.sql.Date;                                                                                                                                                                                                   
import java.time.LocalDate;                                                                                                                                                                                             
import java.util.ArrayList;                                                                                                                                                                                             
import java.util.Scanner;                                                                                                                                                                                               
                                                                                                                                                                                                                        
class Person {                                                                                                                                                                                                          
    String name;                                                                                                                                                                                                        
    String profession;                                                                                                                                                                                                  
    int bookCount;                                                                                                                                                                                                      
                                                                                                                                                                                                                        
    public Person(String name, String profession, int bookCount) {                                                                                                                                                      
        this.name = name;                                                                                                                                                                                               
        this.profession = profession;                                                                                                                                                                                   
        this.bookCount = bookCount;                                                                                                                                                                                     
    }                                                                                                                                                                                                                   
}                                                                                                                                                                                                                       
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
class Book{                                                                                                                                                                                                             
    String name;                                                                                                                                                                                                        
    int id;                                                                                                                                                                                                             
    String borrowerName;                                                                                                                                                                                                
    LocalDate issueDate;                                                                                                                                                                                                
    LocalDate returnDate;                                                                                                                                                                                               
                                                                                                                                                                                                                        
    public Book(String name, int id, String borrowerName, LocalDate issueDate, LocalDate returnDate) {                                                                                                                  
        this.name = name;                                                                                                                                                                                               
        this.id = id;                                                                                                                                                                                                   
        this.borrowerName = borrowerName;                                                                                                                                                                               
        this.issueDate = issueDate;                                                                                                                                                                                     
        this.returnDate = returnDate;                                                                                                                                                                                   
    }                                                                                                                                                                                                                   
                                                                                                                                                                                                                        
    public void setBorrowerName(String borrowerName) {                                                                                                                                                                  
        this.borrowerName = borrowerName;                                                                                                                                                                               
    }                                                                                                                                                                                                                   
                                                                                                                                                                                                                        
    public void setIssueDate(LocalDate issueDate) {                                                                                                                                                                     
        this.issueDate = issueDate;                                                                                                                                                                                     
    }                                                                                                                                                                                                                   
                                                                                                                                                                                                                        
    public void setReturnDate(LocalDate returnDate) {                                                                                                                                                                   
        this.returnDate = returnDate;                                                                                                                                                                                   
    }                                                                                                                                                                                                                   
}                                                                                                                                                                                                                       
                                                                                                                                                                                                                        
class BookMenu {                                                                                                                                                                                                        
                                                                                                                                                                                                                        
    void showBooks(){                                                                                                                                                                                                   
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
        for( Book book : Main.books)                                                                                                                                                                                    
        {                                                                                                                                                                                                               
            System.out.println(book.id + "." + book.name + "\n");                                                                                                                                                       
        }                                                                                                                                                                                                               
                                                                                                                                                                                                                        
        if(Main.books.isEmpty()) { System.out.println("SORRY NO BOOK IS AVAILABLE IN DATABASE!!!");return;}                                                                                                             
        System.out.println("Enter book no for further details or 0 for return");                                                                                                                                        
        int c;                                                                                                                                                                                                          
        Scanner in = new Scanner(System.in);                                                                                                                                                                            
        c  = in.nextInt();                                                                                                                                                                                              
                                                                                                                                                                                                                        
        Book selectedBook = searchBookId(c);                                                                                                                                                                            
                                                                                                                                                                                                                        
        if(selectedBook == null)                                                                                                                                                                                        
        {                                                                                                                                                                                                               
            return;                                                                                                                                                                                                     
        }                                                                                                                                                                                                               
        //show details of this book now;                                                                                                                                                                                
                                                                                                                                                                                                                        
        else{                                                                                                                                                                                                           
            showDetails(selectedBook);                                                                                                                                                                                  
        }                                                                                                                                                                                                               
                                                                                                                                                                                                                        
    }                                                                                                                                                                                                                   
                                                                                                                                                                                                                        
    private void showDetails(Book selectedBook) {                                                                                                                                                                       
        System.out.println("Book id : " + selectedBook.id + "\nBook Name: " + selectedBook.name );                                                                                                                      
                                                                                                                                                                                                                        
            if(selectedBook.borrowerName != null)                                                                                                                                                                       
            {                                                                                                                                                                                                           
                System.out.println("This book has been issued.");                                                                                                                                                       
                System.out.println("BorrowerName: " + selectedBook.borrowerName + " Issue Date: " + selectedBook.issueDate + " Return Date: " + selectedBook.returnDate);                                               
                                                                                                                                                                                                                        
            }                                                                                                                                                                                                           
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
            System.out.println("\nOptions available for this books");                                                                                                                                                   
            System.out.println("1.DeleteBook 2.IssueBook 3.ReturnBook");                                                                                                                                                
            Scanner in = new Scanner(System.in);                                                                                                                                                                        
            int o = in.nextInt();                                                                                                                                                                                       
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
            switch ( o )                                                                                                                                                                                                
            {                                                                                                                                                                                                           
                case 1: Main.books.remove(selectedBook);                                                                                                                                                                
                    System.out.println("Book has been Deleted Successfully!!..");                                                                                                                                       
                    break;                                                                                                                                                                                              
                                                                                                                                                                                                                        
                case 2:                                                                                                                                                                                                 
                                                                                                                                                                                                                        
                    if(selectedBook.borrowerName != null ) {  System.out.println("Error! This book is already issued!"); return; }                                                                                      
                                                                                                                                                                                                                        
                    //else                                                                                                                                                                                              
                                                                                                                                                                                                                        
                    System.out.println("Enter Borrower Name and Profession");                                                                                                                                           
                    String bName = in.next();                                                                                                                                                                           
                    String profession = in.next();                                                                                                                                                                      
                                                                                                                                                                                                                        
                    Person person = findPerson(bName,profession);                                                                                                                                                       
                                                                                                                                                                                                                        
                    if(person == null) {                                                                                                                                                                                
                        person = new Person(bName, profession ,0);                                                                                                                                                      
                        Main.persons.add(person);                                                                                                                                                                       
                    }                                                                                                                                                                                                   
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                    if(person.profession.equals("student"))                                                                                                                                                             
                    {                                                                                                                                                                                                   
                        if(person.bookCount >2)                                                                                                                                                                         
                        {                                                                                                                                                                                               
                            System.out.println("Error !! Can't borrow books more than 5 for a student");                                                                                                                
                            break;                                                                                                                                                                                      
                        }                                                                                                                                                                                               
                    }                                                                                                                                                                                                   
                                                                                                                                                                                                                        
                    else if(person.profession.equals("faculty"))                                                                                                                                                        
                    {                                                                                                                                                                                                   
                        if(person.bookCount >3)                                                                                                                                                                         
                        {                                                                                                                                                                                               
                            System.out.println("Error !! Can't borrow books more than 10 for a faculty");                                                                                                               
                        }                                                                                                                                                                                               
                        break;                                                                                                                                                                                          
                    }                                                                                                                                                                                                   
                                                                                                                                                                                                                        
                    person.bookCount++;                                                                                                                                                                                 
                    selectedBook.setBorrowerName(person.name);                                                                                                                                                          
                                                                                                                                                                                                                        
                    System.out.println("Enter Issue Date(Year,Month,Day)");                                                                                                                                             
                    LocalDate iDate = LocalDate.of(in.nextInt(),in.nextInt(),in.nextInt());                                                                                                                             
                    selectedBook.setIssueDate(iDate);                                                                                                                                                                   
                                                                                                                                                                                                                        
                    if(person.profession.equals("student"))                                                                                                                                                             
                    {                                                                                                                                                                                                   
                        selectedBook.setReturnDate(selectedBook.issueDate.plusDays(15));                                                                                                                                
                    }                                                                                                                                                                                                   
                    else                                                                                                                                                                                                
                    {                                                                                                                                                                                                   
                        selectedBook.setReturnDate(selectedBook.issueDate.plusDays(30));                                                                                                                                
                    }                                                                                                                                                                                                   
                                                                                                                                                                                                                        
                    System.out.println("Book has been Issued Successfully...");                                                                                                                                         
                    break;                                                                                                                                                                                              
                                                                                                                                                                                                                        
                case 3:                                                                                                                                                                                                 
                    System.out.println("Return Book in process.....");                                                                                                                                                  
                                                                                                                                                                                                                        
                        if(Main.today.compareTo(selectedBook.returnDate) > 7)                                                                                                                                           
                        {                                                                                                                                                                                               
                            int span2 = Main.today.compareTo(selectedBook.returnDate) - 7;                                                                                                                              
                            double charge = 7 * 2.50;                                                                                                                                                                   
                            charge += span2 * 5;                                                                                                                                                                        
                                                                                                                                                                                                                        
                            System.out.println("Charged for the late return (after " + span2 + 7 + "days) is " + "Rs." + charge);                                                                                       
                            System.out.println("....................");                                                                                                                                                 
                            System.out.println("This book is successfully returned now..");                                                                                                                             
                                                                                                                                                                                                                        
                            selectedBook.borrowerName = null;                                                                                                                                                           
                            selectedBook.setReturnDate(null);                                                                                                                                                           
                            selectedBook.setIssueDate(null);                                                                                                                                                            
                        }                                                                                                                                                                                               
                                                                                                                                                                                                                        
                        else if(Main.today.compareTo(selectedBook.returnDate) <= 7 && Main.today.compareTo(selectedBook.returnDate) > 0)                                                                                
                        {  double charge = Main.today.compareTo(selectedBook.returnDate) * 2.50;                                                                                                                        
                            System.out.println("Charged for the late return (after " +Main.today.compareTo(selectedBook.returnDate)  + "days) is " + "Rs." + charge);                                                   
                            System.out.println("....................");                                                                                                                                                 
                            System.out.println("This book is successfully returned now..");                                                                                                                             
                                                                                                                                                                                                                        
                            selectedBook.borrowerName = null;                                                                                                                                                           
                            selectedBook.setReturnDate(null);                                                                                                                                                           
                            selectedBook.setIssueDate(null);                                                                                                                                                            
                        }                                                                                                                                                                                               
                                                                                                                                                                                                                        
                    else {                                                                                                                                                                                              
                        System.out.println("This book has been returned with no charge.");                                                                                                                              
                                                                                                                                                                                                                        
                        selectedBook.borrowerName = null;                                                                                                                                                               
                        selectedBook.setReturnDate(null);                                                                                                                                                               
                        selectedBook.setIssueDate(null);                                                                                                                                                                
                    }                                                                                                                                                                                                   
                                                                                                                                                                                                                        
            }                                                                                                                                                                                                           
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
    }                                                                                                                                                                                                                   
                                                                                                                                                                                                                        
    private Person findPerson(String bName, String profession) {                                                                                                                                                        
        for(Person person: Main.persons)                                                                                                                                                                                
        {                                                                                                                                                                                                               
            if(bName.equals(person.name) && profession.equals(person.profession))                                                                                                                                       
            {                                                                                                                                                                                                           
                return person;                                                                                                                                                                                          
            }                                                                                                                                                                                                           
                                                                                                                                                                                                                        
        }                                                                                                                                                                                                               
        return null;                                                                                                                                                                                                    
    }                                                                                                                                                                                                                   
                                                                                                                                                                                                                        
    private Book searchBookId(int c)                                                                                                                                                                                    
    {                                                                                                                                                                                                                   
        for(Book book : Main.books)                                                                                                                                                                                     
        {                                                                                                                                                                                                               
            if(book.id == c)                                                                                                                                                                                            
            {                                                                                                                                                                                                           
                return book;                                                                                                                                                                                            
            }                                                                                                                                                                                                           
        }                                                                                                                                                                                                               
                                                                                                                                                                                                                        
        return null;                                                                                                                                                                                                    
    }                                                                                                                                                                                                                   
}                                                                                                                                                                                                                       
                                                                                                                                                                                                                        
class BookWork{                                                                                                                                                                                                         
                                                                                                                                                                                                                        
}                                                                                                                                                                                                                       
                                                                                                                                                                                                                        
public class Main{                                                                                                                                                                                                      
    static ArrayList<Book> books = new ArrayList<>();                                                                                                                                                                   
    static ArrayList<Person> persons = new ArrayList<>();                                                                                                                                                               
    static LocalDate today = LocalDate.now();                                                                                                                                                                           
    public static void main(String[] args)                                                                                                                                                                              
    {                                                                                                                                                                                                                   
                                                                                                                                                                                                                        
        while(true)                                                                                                                                                                                                     
        {                                                                                                                                                                                                               
            System.out.println("\n\nHi Today is: " + Main.today);                                                                                                                                                       
            System.out.println("1.Add Books 2.Show Books 3.(Today + 1) 4.(Today - 1) 5.(Today + 5) 6.(Today -5) 7.Notices");                                                                                            
            int c;                                                                                                                                                                                                      
            Scanner in = new Scanner(System.in);                                                                                                                                                                        
            c = in.nextInt();                                                                                                                                                                                           
            switch (c)                                                                                                                                                                                                  
            {                                                                                                                                                                                                           
                case 1: addBook();                                                                                                                                                                                      
                    break;                                                                                                                                                                                              
                                                                                                                                                                                                                        
                case 2: BookMenu bookMenu = new BookMenu();                                                                                                                                                             
                    bookMenu.showBooks();                                                                                                                                                                               
                    break;                                                                                                                                                                                              
                                                                                                                                                                                                                        
                case 3: Main.today = Main.today.plusDays(1);                                                                                                                                                            
                        break;                                                                                                                                                                                          
                                                                                                                                                                                                                        
                case 4: Main.today = Main.today.plusDays(-1);                                                                                                                                                           
                        break;                                                                                                                                                                                          
                                                                                                                                                                                                                        
                case 5: Main.today = Main.today.plusDays(5);                                                                                                                                                            
                        break;                                                                                                                                                                                          
                                                                                                                                                                                                                        
                case 6: Main.today = Main.today.plusDays(-5);                                                                                                                                                           
                        break;                                                                                                                                                                                          
                                                                                                                                                                                                                        
                case 7: for(Book book: Main.books)                                                                                                                                                                      
                        {                                                                                                                                                                                               
                            if(book.returnDate == null)                                                                                                                                                                 
                            {                                                                                                                                                                                           
                                continue;                                                                                                                                                                               
                            }                                                                                                                                                                                           
                            if(book.returnDate.isEqual(Main.today))                                                                                                                                                     
                            {                                                                                                                                                                                           
                                System.out.println("\nToday is the due date for the book with details below! ");                                                                                                        
                                System.out.println("Book Name: " + book.name + " Book Id: " + book.id);                                                                                                                 
                                System.out.println("BorrowerName: " + book.borrowerName + " Issue Date: " + book.issueDate + " Return Date: " + book.returnDate);                                                       
                            }                                                                                                                                                                                           
                            else if(Main.today.compareTo(book.returnDate) > 7)                                                                                                                                          
                            {                                                                                                                                                                                           
                                System.out.println("\nOverDue notice!!!!");                                                                                                                                             
                                System.out.println("It has been " + Main.today.compareTo(book.returnDate) + " Days till due date");                                                                                     
                                System.out.println("Book Name: " + book.name + " Book Id: " + book.id);                                                                                                                 
                                System.out.println("BorrowerName: " + book.borrowerName + " Issue Date: " + book.issueDate + " Return Date: " + book.returnDate);                                                       
                            }                                                                                                                                                                                           
                        }                                                                                                                                                                                               
                        break;                                                                                                                                                                                          
                                                                                                                                                                                                                        
                 default: return;                                                                                                                                                                                       
                                                                                                                                                                                                                        
            }                                                                                                                                                                                                           
        }                                                                                                                                                                                                               
                                                                                                                                                                                                                        
    }                                                                                                                                                                                                                   
                                                                                                                                                                                                                        
    private static void addBook() {                                                                                                                                                                                     
        System.out.println("Enter Details of the Book: (name, id)");                                                                                                                                                    
        Scanner in = new Scanner(System.in);                                                                                                                                                                            
        Book book  = new Book(in.next(), in.nextInt(), null, null, null);                                                                                                                                               
        books.add(book);                                                                                                                                                                                                
        System.out.println("Book is Added Successfully to Library Database");                                                                                                                                           
    }                                                                                                                                                                                                                   
}                                                                                                                                                                                                                       
                                                                                                                                                                                                                        
